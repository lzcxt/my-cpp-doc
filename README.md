# 项目介绍

[本项目](https://github.com/lzcxt/my-cpp-doc)希望能够实现一个拥有图形界面的 c++ 项目代码可视化工具。
我们希望能够根据项目根目录自动生成项目的类结构关系图（类的继承与包含），
并且支持简单的交互（如：鼠标悬停显示详细信息，鼠标单击进入进一步说明）
来辅助程序员理解代码逻辑结构。

目标效果参考图：

<img src="https://user-images.githubusercontent.com/29557829/177030052-2afc6cd2-b4e2-437e-9898-e6eebeaf8206.jpg" width="400"/>

### 需求分析
* 开发过程中，程序架构描述的越清晰，程序员之间的合作就会越便利；
* 代码修改时，纷繁复杂的文件并不会特别容易阅读；
* 文档写作耗时而且不够详细，能够一键生成代码介绍图将是每个开发者的梦想。

### 竞品分析
在这方面已经有很多相关工作了，如：
1. [doxygen](https://github.com/doxygen/doxygen) 最有名的 c++ 文档自动生成工具。
2. [bouml](https://www.bouml.fr/) 高效静态代码分析工具

相比于它们，本项目仅仅只是一个新手的项目实践尝试。

# 日程安排

| 任务        | 所需时间(天)     |
|:------------|:---------------:|
| 总时间       |   7             |
| 第一轮迭代   |   3 (day456)    |
| 第二轮迭代   |   2 (day78)     |
| 第三轮迭代   |   2 (day9 - 10) |

[开发日志](https://github.com/lzcxt/my-cpp-doc/wiki/开发日志)

# 开发工具

* QT：5.12.12_msvc2017
* Visual Studio 2017
* glut: 3.7

# 人员配置

| 人员 |   角色       |       分工             |
|:-----|:-----------:|:----------------------:|
| zhr  | View(界面和绘图资源), App |   功能分析和流程控制     |
| xcy  | View(绘图部分) |   展示关系图             |
| cxt  | Model, View-Model  |   读取/解析c++源代码      |

# 第一轮迭代（6.30 - 7.2）

### 目标：
1. 多文件中类的继承关系的识别。
2. 类的继承关系的导出和展示。

### View 层完成情况：

界面和绘图资源上：
* 实现了简单的菜单界面和读入文件操作。
* 完成了从View-Model层数据到绘图所需资源的转化。
* 完成了文件读取信号、绘图信号等的实现和接收。

可视化实现上：
* 根据VM层提供的类的元数据、成员数据设计类的通用展示形式：矩形框内从上至下展示类的元数据与成员数据，
其中类的元数据即名字文本下划线且加大。矩形框的宽度和高度与内含文本相适应。
* 安排不同类之间的简单布局，在窗口中每行最多设置两个类的展示，该行高度由两个类的最大高度决定，
窗口宽度由各行最大宽度决定。
* 根据VM层提供的类关系数据，设计继承的展示形式：由子类的左上角连线一条箭头指向父类的右下角。

### Model & View-Model 层完成情况
* View-Model 层的 parser 调用 Model 层的 CppFileContent 来解析内容。
* CppFileContent 首先将文件内容的词素进行分割，然后利用有限状态自动机来读取类的继承关系。

### Common 层完成情况
* Common 层包含 Class 类表示其它三层间数据交换所需要的形式。

### 第一轮迭代结果
<img src="https://user-images.githubusercontent.com/29557829/177031425-55ff8113-e7c5-4db7-8c4f-5f0483a093db.png" width="400"/>

<img src="https://user-images.githubusercontent.com/29557829/177031205-a9500c8b-0c53-40b6-89a7-2990dc19472d.jpg" width="200"/>

这是 [test/round_1/test1_singlefile.cpp](https://github.com/lzcxt/my-cpp-doc/blob/main/test/round_1/test1_singlefile.cpp) 的读取结果。
图中凌乱的箭头表示类的继承关系。

# 第二轮迭代（计划）（7.3 - 7.4）

### 目标
1. （model）完成类内函数的读取以及类内成员变量的读取。
2. （view）实现鼠标悬停后在状态栏显示信息。
3. （view）实现关系图线的排布，使其更加简洁清晰。
4. （view）拥有更大的画布，支持放大缩小，支持鼠标拖动/滚轮滚动显示。
5. （all）重新调整文件结构

# 还需要实现的功能
1. 项目内关系的导出（尝试读取cmake文件信息等）
2. 悬停显示注释 / 类的函数，点击进入类说明图片，添加返回按钮。
3. 实现较复杂类关系图和利用滚轮等工具的查看及绘图。
